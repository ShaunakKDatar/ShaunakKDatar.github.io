<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>GSoC Midterm evaluation :: The SKD Blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Hello readers!
The GSoC 2025 midterm evaluations are here, and I’d like to take this opportunity to summarize the work I’ve done so far. I’m contributing to the RTEMS Project, focusing on adding and improving peripheral support for the Raspberry Pi 4B BSP. My proposal is centered around four core components: I2C, PWM, DMA, and Mailbox. Out of these, I’ve:
Merged I2C support Merged PWM support Got DMA working for memory-to-memory transfers Let’s take a closer look at each component:
" />
<meta name="keywords" content="GSoC 2025, RTEMS BSP, Raspberry Pi 4B, RTEMS device driver, I2C PWM DMA Mailbox RTEMS, Shaunak Datar GSoC" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="../../posts/gsoc-midterm-evaluations/" />







  
  
  
  
  
  <link rel="stylesheet" href="../../styles.css">







  <link rel="shortcut icon" href="../../images/blogfavicon.ico">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="GSoC Midterm evaluation">
<meta property="og:description" content="Hello readers!
The GSoC 2025 midterm evaluations are here, and I’d like to take this opportunity to summarize the work I’ve done so far. I’m contributing to the RTEMS Project, focusing on adding and improving peripheral support for the Raspberry Pi 4B BSP. My proposal is centered around four core components: I2C, PWM, DMA, and Mailbox. Out of these, I’ve:
Merged I2C support Merged PWM support Got DMA working for memory-to-memory transfers Let’s take a closer look at each component:
" />
<meta property="og:url" content="/posts/gsoc-midterm-evaluations/" />
<meta property="og:site_name" content="The SKD Blog" />

  
  
  <meta property="og:image" content="/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-07-15 22:29:25 &#43;0530 IST" />













  


</head>
<body class="blue">




<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="../../">
  <div class="logo">
    shaunak@datar:~$
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="../../posts">Posts</a></li>
        
      
        
          <li><a href="../../about">About</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
      
        
          <li><a href="../../posts" >Posts</a></li>
        
      
        
          <li><a href="../../about" >About</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="../../posts/gsoc-midterm-evaluations/">GSoC Midterm evaluation</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-07-15</time><span class="post-author">Shaunak Datar</span>
    
</div>

  
    <span class="post-tags">
      
      #<a href="../../tags/rtems/">RTEMS</a>&nbsp;
      
      #<a href="../../tags/gsoc/">GSoC</a>&nbsp;
      
      #<a href="../../tags/raspberry-pi/">Raspberry Pi</a>&nbsp;
      
      #<a href="../../tags/bare-metal/">Bare-metal</a>&nbsp;
      
      #<a href="../../tags/device-drivers/">Device-Drivers</a>&nbsp;
      
    </span>
  
  



  

  <div class="post-content"><div>
        <p>Hello readers!</p>
<p>The GSoC 2025 midterm evaluations are here, and I’d like to take this opportunity to summarize the work I’ve done so far. I’m contributing to the RTEMS Project, focusing on adding and improving peripheral support for the Raspberry Pi 4B BSP. My proposal is centered around four core components: <strong>I2C</strong>, <strong>PWM</strong>, <strong>DMA</strong>, and <strong>Mailbox</strong>. Out of these, I’ve:</p>
<ul>
<li><strong>Merged I2C support</strong></li>
<li><strong>Merged PWM support</strong></li>
<li><strong>Got DMA working for memory-to-memory transfers</strong></li>
</ul>
<p>Let’s take a closer look at each component:</p>
<hr>
<h2 id="i2c">I2C<a href="#i2c" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>The I2C peripheral on the Raspberry Pi is accessed via the <code>i2c_bus</code> layer in RTEMS&rsquo;s <code>cpukit</code>. I implemented functions like:</p>
<ul>
<li><code>rpi_i2c_transfer</code></li>
<li><code>rpi_i2c_set_clock</code></li>
<li><code>rpi_i2c_destroy</code></li>
</ul>
<p>&hellip;along with several helper functions to configure the BSC (Broadcom Serial Controller) registers.</p>
<p>I tested the driver using an MPU6050 sensor and verified correct readings. After testing, I raised a <a href="https://gitlab.rtems.org/rtems/rtos/rtems/-/merge_requests/363">merge request</a>.</p>
<p>Most of my time after the testing phase was spent addressing review comments. This helped me understand how to write code that is not only functional, but also <strong>readable</strong>, <strong>maintainable</strong>, and <strong>aligned with RTEMS&rsquo;s coding guidelines</strong>.</p>
<hr>
<h2 id="pwm">PWM<a href="#pwm" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>The second part of my project involved adding support for the PWM peripheral on the Raspberry Pi 4B. PWM was relatively straightforward, and I spent around two weeks getting it up and running.</p>
<p>I implemented functions to initialize the PWM master and individual channels, as well as to update the duty cycle of an already-running channel. Since PWM is tightly coupled with the Clock Manager, I also implemented static helper functions to configure the clock source and dividers.</p>
<p>For testing, I wrote a user application that exercised both PWM channels. PWM0 is mapped to GPIOs, so I verified its output using a logic analyzer. PWM1, however, is connected to the audio jack on the Pi. To test this, I configured it to output a 440Hz tone and connected headphones to hear the sound.</p>
<p>After testing, I submitted a <a href="https://gitlab.rtems.org/rtems/rtos/rtems/-/merge_requests/509">merge request</a>.</p>
<hr>
<h2 id="dma">DMA<a href="#dma" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>DMA is the most involving and interesting part of the project so far. Unlike I2C or PWM, it’s not just about configuring registers—it also involves creating a control block, aligning it to a 256-bit address, and setting up memory for source and destination buffers correctly.</p>
<p>Initially, I tested DMA with a simple single-integer transfer, which worked fine on QEMU but failed on actual hardware. After discussions with my mentors, I realized the issue was due to cache coherence—the CPU cache was not in sync with memory when the DMA engine performed the transfer.</p>
<p>To fix this, I modified the memory allocation to ensure proper cache-line alignment, added manual cache flushes and invalidations using RTEMS APIs, and rewrote the test case to use a larger buffer instead of a single integer. With these changes, the memory-to-memory DMA transfer worked reliably on real hardware.</p>
<p>After some restructuring and cleanup, I plan to raise a merge request for DMA support soon.</p>
<hr>
<p>This has been my progress till the midterm. It&rsquo;s been super fun working on this project—I’m learning a lot of new things and growing as an embedded engineer.</p>
<p>That’s it for now.</p>
<p><strong>Until next time — keep building, keep tinkering, and keep contributing.</strong></p>
<p>Cheers,<br>
Shaunak</p>

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="../../posts/gsoc-midterm-deliverables/">
                <span class="button__text">Bits to BSPs – GSoC Midterm Recap</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/mirus-ua/hugo-theme-re-terminal" target="_blank">Theme</a> made by <a href="https://github.com/mirus-ua" target="_blank">Mirus</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="../../bundle.min.js"></script>








  
</div>

</body>
</html>
